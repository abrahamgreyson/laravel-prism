# Laravel Prism 安装流程更新说明

## 主要改进

### 1. 分阶段安装流程

安装过程现在分为两个明确的步骤：

**步骤 1: Laravel 行为配置**
- 不可变日期 (Immutable Date)
- 模型严格模式 (Model Strict)
- 解除模型保护 (Unguard Models)
- 禁止破坏性命令 (Prohibit Destructive Commands)
- 统一格式的响应 (Unified Response)

**步骤 2: 第三方包安装**
- Laravel Telescope
- 未来可扩展其他包

### 2. 改进的输出显示

- ✅ 显示 composer 命令的完整输出
- ✅ 显示将要执行的命令
- ✅ 使用表情符号和颜色增强用户体验
- ✅ 区分成功/失败状态

### 3. 更好的错误处理

- ✅ 根据失败步骤提供针对性建议
- ✅ 自动清除缓存避免命令识别问题
- ✅ 不再让用户重复已成功的步骤

### 4. 精确的配置更新

- ✅ 只更新用户选择的配置项
- ✅ 分别处理基础配置和 telescope 配置
- ✅ 避免全部设为 true 的问题

## 使用示例

```bash
php artisan prism:install
```

**新的交互流程：**

```
🚀 开始安装 Prism 包...

📝 步骤 1: 配置 Laravel 行为
┌ 请选择要启用的 Laravel 行为配置： ────────────────────────────────────────┐
│ ● 不可变日期 (Immutable Date)                                              │
│ ● 模型严格模式 (Model Strict)                                             │
│ ● 解除模型保护 (Unguard Models)                                           │
│ ● 禁止破坏性命令 (Prohibit Destructive Commands)                          │
│ ● 统一格式的响应 (Unified Response)                                       │
└────────────────────────────────────────────────────────────────────────────┘

📦 步骤 2: 选择第三方包
┌ 请选择要安装的第三方包： ──────────────────────────────────────────────────┐
│ ○ Laravel Telescope - 调试和性能分析工具（将引导安装过程）                │
└────────────────────────────────────────────────────────────────────────────┘
```

## 关键修复

### Telescope 安装流程

1. **命令输出显示**：现在会显示完整的 composer 输出
2. **缓存清理**：安装包后自动清理缓存
3. **错误区分**：根据失败的具体步骤给出建议
4. **步骤追踪**：清楚显示每个步骤的成功/失败状态

### 配置文件更新

1. **选择性更新**：只更新用户选择的配置项
2. **telescope 配置**：正确处理嵌套的 telescope 配置
3. **默认值管理**：第三方包默认不选择，避免意外安装

这些改进解决了你提到的所有问题：
- ✅ 不再吞掉命令输出
- ✅ 精确的错误处理和建议
- ✅ 正确的配置文件更新
- ✅ 清晰的两步安装流程
